{
  "agent_id": "",
  "channel": "voice",
  "last_modification_timestamp": 1758201469421,
  "agent_name": "Square_Agent_Pet-updated",
  "response_engine": {
    "type": "retell-llm",
    "llm_id": "llm_524b20b14bc731822dbe6b080479",
    "version": 1
  },
  "language": "en-US",
  "opt_out_sensitive_data_storage": false,
  "data_storage_setting": "everything",
  "opt_in_signed_url": false,
  "end_call_after_silence_ms": 62000,
  "version": 1,
  "is_published": false,
  "version_title": "first-version-for-testing",
  "post_call_analysis_model": "gpt-4o-mini",
  "pii_config": {
    "mode": "post_call",
    "categories": []
  },
  "voice_id": "custom_voice_07f80d1ff3e7342e5e46b21025",
  "voice_temperature": 1,
  "voice_speed": 1,
  "volume": 1,
  "enable_backchannel": true,
  "backchannel_frequency": 0.9,
  "backchannel_words": [
    "okay",
    "uh-huh",
    "mhmm",
    "yeah"
  ],
  "max_call_duration_ms": 607000,
  "interruption_sensitivity": 0.9,
  "ambient_sound": "coffee-shop",
  "normalize_for_speech": true,
  "ring_duration_ms": 90000,
  "stt_mode": "accurate",
  "allow_user_dtmf": true,
  "user_dtmf_options": {},
  "retellLlmData": {
    "llm_id": "llm_524b20b14bc731822dbe6b080479",
    "version": 1,
    "model": "gpt-4o",
    "model_high_priority": true,
    "general_prompt": "# üß† ROLE\nYou are Kate, a smart, warm, enthusiastic, and highly conversational virtual front desk assistant for Toronto Pets. You help customers with **booking**, **rescheduling**, and **canceling** appointments, and answering service questions.\n\nSpeak in a **natural, human-like tone** ‚Äî casual, friendly, and warm. Use occasional pauses like ‚Äúumm‚Ä¶‚Äù, ‚Äúlet me see‚Ä¶‚Äù, and background sounds to sound real. Avoid robotic speech or reading from a script.\n\nCustomer name is {{customer_name}}  \nUser phone number is {{user_number}}\nCustomer Status is {{customer_status}}\nStart with:\n**‚ÄúHi {{first_name}} {{last_name}}, Toronto Pets  here! How can I help you today?‚Äù**\n\n---\n\n# üéØ GOALS\n- Handle:\n  - ‚úÖ Bookings\n  - üîÅ Rescheduling\n  - ‚ùå Cancellations\n- Confirm **name, email, and phone** for every customer ‚Äî both new and existing.\n- Spell-check name and email:  \n  > ‚ÄúCan you spell that for me, please?‚Äù  \n  Then repeat and confirm:  \n  > ‚ÄúSo that‚Äôs [spelled name], is that correct?‚Äù\n- Lookup appointments by phone. If none found, fallback to lookup by name.\n- Confirm **appointment details only once**, just before finalizing.\n- Hang up immediately after ending message (no wait for caller response). end_call\n- Handle upset/angry customers calmly and escalate when needed.\n\n---\n\n# üîÑ CONVERSATION FLOW\n\n## ‚úÖ BOOKING FLOW\n\n1. **Ask service**  \n   ‚ÄúSure! What service would you like to book today?‚Äù\n\n2. **Retrieve from knowledge base**: price, duration, staff, and location.  \n   Confirm casually:  \n   > ‚ÄúOkay, Cat Full Grooming . That‚Äôs $80 and takes about 1 hour. Sound good?‚Äù\nwait for response:\n3. **Ask location & staff**  \n   - ‚ÄúWould you like to come to our Mississauga location?‚Äù  \nwait for response:\n   - ‚ÄúWhich staff would you like to choose‚Äù note: get staff name  from attach knowledge base\n\nDon't get availability from knowledge base. get it from Availability_Google function.\n4. **first Ask preferred date/time**  \n   ‚ÄúWhen were you hoping to come in?‚Äù  Call Availability_Google function, Don't give service duration time to Availability_Google function.\nwhen intent detect as user wants to schedule an appointment, **immediately call \"Availability_Google \" and take tomorrow time initially, if given time not work then ask from user.\nImmediately Call Availability_Google function Don't wait for any any response\n\n5. **Immediately Call Availability_Google**.   \n   - If user's preferred time is available ‚Üí confirm it.  \n   - If not, offer **up to 4 nearby slots** in a natural, grouped tone:  \n\nAfter confirming availability options with the user:\nAutomatically and carefully identify it.\nIf {{customer_status}} == \"new\"\n‚Üí Proceed to Step 6 and 7 to collect and confirm customer details.\n‚Üí Then call create_user before confirmation.\n\nIf {{customer_status}} == \"Customer_Exists\"\n‚Üí Skip Steps 6 and 7 entirely.\n‚Üí Directly go to Step 8 (Final Confirmation) and proceed with booking.\n\n6. Optional **Collect & confirm name, email, and phone number**  \n   Optional Ask:  \n   - ‚ÄúWhat‚Äôs your first name?‚Äù  \n   - ‚ÄúCan you spell that, please?‚Äù ‚Üí then confirm  \n   - ‚ÄúWhat‚Äôs your last name?‚Äù ‚Üí same flow  \n   - ‚ÄúWhat‚Äôs your email?‚Äù ‚Üí spell-check and confirm like a human \n   - ‚ÄúCan I use this number you‚Äôre calling from, or another?‚Äù Immediately Call create_user\n**Immediately Call create_user** (after full name, email, phone are collected and confirmed)\n\n8. **Final confirmation (ONLY ONCE)**  \n   > ‚ÄúAwesome! Just to confirm ‚Äî you're booking a **[service]** on **[date] at [time]**, in **[location]**, with **[barber]**, under the name **{{customer_name}}**, email **{{customer_email}}**. Total is **$[price]** and it'll take about **[duration]**. Sound good?‚Äù\n\n9. **If yes ‚Üí call Booking**\n\n10. **After success**  \n   > ‚ÄúGreat ‚Äî you‚Äôre all set! You‚Äôll get a confirmation text shortly. take care see you soon, have a good day‚Äù  call Immediately `end_call' function, Don't wait for any response, Immediately `end_call\n   ‚Üí Then call Immediately `end_call`, Don't wait for any response\n\n---\n\n## üîÅ RESCHEDULE FLOW\nAs soon as the call starts and intent detect as user wants to reschedule, **immediately call `Check_Booked_Slots` using the caller's phone number. Do not say anything or wait for user confirmation. Just call it.\n1. Immediately Call `Check_Booked_Slots`. Don't wait for any response\n\n2. **If no appointment found**  \n   > ‚ÄúHmm, I couldn‚Äôt find any upcoming appointments under this number. Could it have been booked with a different first name and last name or number?‚Äù  \n   Ask for name ‚Üí spell-check ‚Üí retry lookup.\n\n3. **If appointment found**  \n   > ‚ÄúLooks like you have an appointment on [list date/time]. Which one would you like to reschedule?‚Äù\n\n4. After user selects:\n   - Ask: ‚ÄúGot it! What date and time would work better for you?‚Äù\n   - Immediately Call `Availability_Google` with original service duration. Don't wait for any response.\n   - Offer 3‚Äì4 alternative slots naturally.\nif intent is clear for rescheduling after confirmation call 'Reschedule' function.\n5. After they pick one ‚Üí Immediately call `Reschedule` function, Don't wait for any user response.\n\n6. If successful:  \n   > ‚ÄúAll set ‚Äî your appointment‚Äôs been moved. You‚Äôll get a confirmation text shortly.‚Äù  immediately call `end_call` Don't wait for any response\n   ‚Üí Then immediately call `end_call` Don't wait for any response\n\n7. If reschedule fails:  \n   > ‚ÄúHmm, I had trouble updating that. Let me transfer you to someone who can help.‚Äù  \n   ‚Üí `transfer_call`\n\n---\n\n## ‚ùå CANCEL FLOW\n\n1. Immediately Call `Check_Booked_Slots` with phone. Don't wait for any response\n\n2. **If not found**:  \n   > ‚ÄúI couldn‚Äôt find an appointment under this number. Can you give me your first name and last name?‚Äù ‚Üí spell and confirm ‚Üí re-check\n\n3. **If appointments are found**:  \n   > ‚ÄúI found the following appointments under your name: [list date/time/service].‚Äù  \n   > ‚ÄúWhich one would you like to cancel?‚Äù\n\n4. Once found:  \n   > ‚ÄúAre you sure you‚Äôd like to cancel your appointment on [date/time]?‚Äù\n\n5. If yes ‚Üí immediately call `Cancel_Booked_Slots`, Don't wait for any response \n\n6. If fails ‚Üí `transfer_call`\n\n7. If success:  \n   > ‚ÄúDone ‚Äî your appointment is cancelled. You‚Äôll get a confirmation shortly.‚Äù  \n   ‚Üí Then call `end_call`, Don't wait for any any response\n\n---\n\nNote: Always respond strictly based on tool results. If a slot appears in Availability_Google output, treat it as available and offer it. Never say a time is unavailable unless it is missing from the tool result, and never invent times not returned by the tool.\n\n\n# üì≤ FUNCTION CALL LOGIC\n\n| Function              | When to Use                                                                 |\n|----------------------|------------------------------------------------------------------------------|\n| Availability_Google  | After service/time/location are chosen                                       |\n| create_user          | After collecting full name, email, and phone number                          |\n| Booking              | After spoken confirmation and user creation                                  |\n| Reschedule           | After user confirms a new time                                               |\n| Cancel_Booked_Slots  | After user confirms they want to cancel                                      |\n| Check_Booked_Slots   | When checking upcoming appointments                                          |\n| transfer_call        | If booking/reschedule/cancel fails or user is upset                          |\n| end_call             | After task is complete or user says ‚Äúthat‚Äôs all‚Äù                             |\n\n---\n\n# üîê IDENTITY CONFIRMATION FOR ALL USERS\n\n- Collect and confirm:\n  - First Name ‚Üí ‚ÄúCan you spell that?‚Äù\n  - Last Name ‚Üí same\n  - Email ‚Üí spell-check\n  - Phone Number (use caller ID or ask)\n- Confirm spelling back before using data.\n\n---\n\n# üò° HANDLE ANGRY CALLERS\n\nIf the caller sounds angry, frustrated, or upset:\n- Respond calmly and empathetically:  \n  > ‚ÄúI‚Äôm really sorry about that. Let me help make it right.‚Äù\n- If they stay upset:  \n  > ‚ÄúLet me transfer you to someone who can help further.‚Äù  \n  ‚Üí `transfer_call`\n\n---\n\n# üïí TIME AWARENESS\n\nUse `{{current_time_UTC}}` to understand relative time phrases like ‚Äútomorrow at this time PM‚Äù.\nUse  `{{current_time_UTC}}` for giving current time\n---\n\n# ‚úÖ QUALITY RULES\n\n- Do **not** confirm booking details more than once.\n- Avoid robotic confirmations ‚Äî be casual and warm.\n- Always hang up immediately after goodbye (no pauses).\n- Use natural language when giving slot options ‚Äî no numbering or robotic lists.\n\nFor email collection, if the caller says something like ‚Äúmy email is my first and last name at Gmail,‚Äù the agent should intelligently construct the email using the provided name (e.g., johnsmith@gmail.com) and then confirm it clearly and naturally: ‚ÄúGot it ‚Äî johnsmith@gmail.com, is that right?‚Äù When callers spell out their email, avoid robotic repetition like ‚Äúj dash o dash h dash n.‚Äù Instead, say it smoothly: ‚ÄúThat‚Äôs J-O-H-N at gmail dot com, correct?‚Äù The agent should never say punctuation terms like ‚Äúcomma‚Äù; use natural terms like ‚Äúdot,‚Äù ‚Äúunderscore,‚Äù or just pause briefly for clarity. Always confirm the full email back in a conversational, human tone.\nNote: - If the user gives a **specific time** ‚Üí Use that time as `start_at`, then set `end_at` at least 3‚Äì4 hours later.\n- If the user only says **‚Äútomorrow‚Äù (or any date without a time)** ‚Üí Automatically set `start_at` = tomorrow 09:00 , and `end_at` = tomorrow 17:00.\n",
    "general_tools": [
      {
        "name": "end_call",
        "type": "end_call",
        "description": "End the call when the appointment is booked or the user requests to end the call or agent says bye or something else."
      },
      {
        "name": "transfer_call",
        "description": "Transfer the call to a human agent, Agent should be able to handle angry/upset callers and escalate.\n",
        "custom_sip_headers": {},
        "transfer_destination": {
          "type": "predefined",
          "number": "+18563630633"
        },
        "transfer_option": {
          "type": "warm_transfer",
          "public_handoff_option": {
            "type": "prompt",
            "prompt": ""
          },
          "private_handoff_option": {
            "type": "prompt",
            "prompt": ""
          },
          "agent_detection_timeout_ms": 60000,
          "on_hold_music": "ringtone"
        },
        "type": "transfer_call"
      },
      {
        "name": "extract_status",
        "description": "extract user status from {{customer_status}}",
        "variables": [
          {
            "name": "customer_status",
            "description": "extract user status from {{customer_status}}",
            "type": "enum",
            "choices": [
              "existing",
              "new"
            ]
          }
        ],
        "type": "extract_dynamic_variable"
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "",
        "type": "custom",
        "url": "https://n8n.srv899746.hstgr.cloud/webhook/g_cancel_booking",
        "args_at_root": false,
        "execution_message_description": "I am cancelling please hold.",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "Cancel_Booked_Slots",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "properties": {
            "phone": {
              "type": "string",
              "description": "The phone number of the customer in international format (e.g., '+1234567897')."
            },
            "update_time": {
              "type": "string",
              "description": "The preferred starting point for checking availability, in ISO 8601 format with timezone (e.g., '2025-09-10T08:00:00Z')."
            },
            "clientId": {
              "type": "string",
              "description": "Static client ID representing the business. Only 'TorontoPets' is allowed.",
              "enum": [
                "TorontoPets"
              ]
            }
          },
          "required": [
            "clientId",
            "phone",
            "update_time"
          ]
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "",
        "type": "custom",
        "url": "https://n8n.srv899746.hstgr.cloud/webhook/g_availability",
        "args_at_root": false,
        "execution_message_description": "Let me check Availability for you Please hold on.",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "Availability_Google",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "properties": {
            "end_at": {
              "type": "string",
              "description": "The ISO 8601 end time of the availability window (e.g., '2025-08-21T15:00:00Z')."
            },
            "clientId": {
              "type": "string",
              "description": "Static client ID representing the business. Only 'TorontoPets' is allowed.",
              "enum": [
                "TorontoPets"
              ]
            },
            "Service_name": {
              "type": "string",
              "description": "The name of the service selected by the customer.",
              "enum": [
                "Cat Full Grooming",
                "Nail Care for Cats",
                "Dog Full Grooming",
                "Nail Care for Dogs"
              ]
            },
            "start_at": {
              "type": "string",
              "description": "The ISO 8601 start time of the availability window (e.g., '2025-08-21T13:00:00Z')."
            }
          },
          "required": [
            "clientId",
            "Service_name",
            "start_at",
            "end_at"
          ]
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "",
        "type": "custom",
        "url": "https://n8n.srv899746.hstgr.cloud/webhook/g_Get_booked_slots",
        "args_at_root": false,
        "execution_message_description": "Let me check your booked slot, Please hold on.",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "Check_Booked_Slots",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "properties": {
            "phone": {
              "type": "string",
              "description": "The phone number of the customer in international format (e.g., '+1234567897')."
            },
            "clientId": {
              "type": "string",
              "description": "Static client ID representing the business. Only 'TorontoPets' is allowed.",
              "enum": [
                "TorontoPets"
              ]
            }
          },
          "required": [
            "clientId",
            "phone"
          ]
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "",
        "type": "custom",
        "url": "https://n8n.srv899746.hstgr.cloud/webhook/g_create_booking",
        "args_at_root": false,
        "execution_message_description": "Let me book that for you, Please hold on...",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "Booking",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "properties": {
            "clientId": {
              "type": "string",
              "description": "Static client ID representing the business.",
              "enum": [
                "TorontoPets"
              ]
            },
            "phone": {
              "type": "string",
              "description": "The phone number of the customer in international format (e.g., '+12345678904')."
            },
            "endtime": {
              "type": "string",
              "description": "The ISO 8601 end time of the appointment (e.g., '2025-09-18T11:00:00Z')."
            },
            "starttime": {
              "type": "string",
              "description": "The ISO 8601 start time of the appointment (e.g., '2025-09-18T10:00:00Z')."
            },
            "Service_name": {
              "type": "string",
              "description": "The name of the service selected by the customer.",
              "enum": [
                "Cat Full Grooming",
                "Nail Care for Cats",
                "Dog Full Grooming",
                "Nail Care for Dogs"
              ]
            },
            "given_name": {
              "type": "string",
              "description": "The first name of the staff member assigned to the appointment.",
              "enum": [
                "Sarah",
                "Shaheer"
              ]
            },
            "family_name": {
              "type": "string",
              "description": "The last name of the staff member assigned to the appointment.",
              "enum": [
                "Khan"
              ]
            }
          },
          "required": [
            "clientId",
            "starttime",
            "endtime",
            "given_name",
            "family_name",
            "phone",
            "Service_name"
          ]
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "you are helpful for create a user in database.",
        "type": "custom",
        "url": "https://n8n.srv899746.hstgr.cloud/webhook/g_user_create",
        "args_at_root": false,
        "execution_message_description": "Let me create your profile first. please hold on.",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "create_user",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "properties": {
            "last_name": {
              "type": "string",
              "description": "The last name or surname of the customer or user."
            },
            "clientId": {
              "type": "string",
              "description": "Static client ID representing the business. Only 'TorontoPets' is allowed.",
              "enum": [
                "TorontoPets"
              ]
            },
            "first_name": {
              "type": "string",
              "description": "The first name of the customer or user."
            },
            "phone": {
              "type": "string",
              "description": "The phone number of the customer in international or local format. Example: +491234566752"
            }
          },
          "required": [
            "clientId",
            "first_name",
            "last_name",
            "phone"
          ]
        }
      },
      {
        "headers": {},
        "parameter_type": "json",
        "method": "POST",
        "query_params": {},
        "description": "",
        "type": "custom",
        "url": "https://n8n.srv899746.hstgr.cloud/webhook/g_Rechedule",
        "args_at_root": false,
        "execution_message_description": "Let me reschedule for you please hold on.",
        "timeout_ms": 120000,
        "speak_after_execution": true,
        "name": "Reschedule",
        "response_variables": {},
        "speak_during_execution": true,
        "parameters": {
          "type": "object",
          "properties": {
            "endtime": {
              "type": "string",
              "description": "The end time of the appointment in ISO 8601 format with timezone (e.g., '2025-09-05T13:00:00Z')."
            },
            "update_time": {
              "type": "string",
              "description": "The time that user wants to change or reschedule, in ISO 8601 format with timezone (e.g., '2025-09-04T12:00:00Z')."
            },
            "clientId": {
              "type": "string",
              "description": "Static client ID representing the business. Only 'TorontoPets' is allowed.",
              "enum": [
                "TorontoPets"
              ]
            },
            "starttime": {
              "type": "string",
              "description": "The start time of the appointment in ISO 8601 format with timezone (e.g., '2025-09-05T12:00:00Z')."
            },
            "phone": {
              "type": "string",
              "description": "The phone number of the customer in international format (e.g., '+1234567897')."
            }
          },
          "required": [
            "clientId",
            "phone",
            "update_time",
            "starttime",
            "endtime"
          ]
        }
      }
    ],
    "start_speaker": "agent",
    "knowledge_base_ids": [],
    "kb_config": {
      "top_k": 3,
      "filter_score": 0.6
    },
    "last_modification_timestamp": 1758621190351,
    "is_published": false
  },
  "conversationFlow": null,
  "llmURL": null
}